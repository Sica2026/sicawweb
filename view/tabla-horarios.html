<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Tabla de Horarios - Vista Administrativa</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- Base Styles -->
    <link href="../css/base-styles.css" rel="stylesheet">
    <!-- Page Specific Styles -->
    <link id="page-styles" href="../css/tabla-horarios.css" rel="stylesheet">
    <style>
        /* Spinner de carga simple */
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Indicador de status mejorado */
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #ddd;
            transition: all 0.3s ease;
        }
        
        .status-indicator.active {
            background-color: #3498db;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* Mejoras para el modal de asesores */
        .modal-content {
            border: none;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .modal-header {
            border-bottom: 1px solid #eee;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px 12px 0 0;
        }
        
        .modal-header .btn-close {
            filter: invert(1);
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f5f5f5;
        }
        
        .info-label {
            font-weight: 600;
            color: #555;
        }
        
        .info-value {
            color: #333;
        }
        
        .asesor-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .asesor-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
        }
        
        .asesor-info h6 {
            margin: 0;
            color: #333;
        }
        
        .asesor-info p {
            margin: 2px 0;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <!-- Header Component -->
    <div id="header-component"></div>

    <!-- Navigation Component -->
    <div id="navbar-component"></div>

    <!-- Main Content Area -->
    <main class="main-content" id="main-content">
        <div class="container-fluid">
            <!-- Hero Section -->
            <div class="hero-section mb-4">
                <div class="hero-content">
                    <div class="hero-icon">
                        <i class="bi bi-table"></i>
                    </div>
                    <h1 class="hero-title">Tabla de Horarios</h1>
                    <p class="hero-subtitle">Vista matricial de disponibilidad de asesores por horario y sala</p>
                </div>
                <div class="hero-actions">
                    <button class="btn btn-outline-light" onclick="window.location.href='horarios-asesores.html'">
                        <i class="bi bi-arrow-left me-2"></i>Regresar
                    </button>
                </div>
            </div>

            <!-- Control Panel -->
            <div class="control-panel mb-4">
                <div class="row g-3 align-items-center">
                    <div class="col-md-4">
                        <div class="control-group">
                            <label class="control-label">
                                <i class="bi bi-calendar-week me-2"></i>Tipo de Horario
                            </label>
                            <select class="form-select control-select" id="tipoHorarioSelect">
                                <option value="">Seleccionar tipo...</option>
                                <option value="provisional-a">Provisional A</option>
                                <option value="provisional-b">Provisional B</option>
                                <option value="definitivo">Definitivo</option>
                                <option value="bloque-1">Bloque 1</option>
                                <option value="bloque-2">Bloque 2</option>
                                <option value="extraordinarios">Extraordinarios</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="control-group">
                            <label class="control-label">
                                <i class="bi bi-building me-2"></i>Sala
                            </label>
                            <div class="sala-selector">
                                <div class="sala-option active" data-sala="SICA-1">
                                    <i class="bi bi-building"></i>
                                    <span>SICA 1</span>
                                </div>
                                <div class="sala-option" data-sala="SICA-2">
                                    <i class="bi bi-building-fill"></i>
                                    <span>SICA 2</span>
                                </div>
                                <div class="sala-option" data-sala="SICA-4">
                                    <i class="bi bi-buildings"></i>
                                    <span>SICA 4</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="control-group">
                            <label class="control-label">
                                <i class="bi bi-info-circle me-2"></i>Estado
                            </label>
                            <div class="status-info" id="statusInfo">
                                <span class="status-text">Selecciona tipo de horario</span>
                                <div class="status-indicator"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Legend Panel -->
            <div class="legend-panel mb-4">
                <h6><i class="bi bi-palette me-2"></i>Leyenda de Colores</h6>
                <div class="legend-items">
                    <div class="legend-item">
                        <div class="legend-color rojo"></div>
                        <span>0-1 Asesores</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color amarillo"></div>
                        <span>2-3 Asesores</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color verde"></div>
                        <span>4 Asesores</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color naranja"></div>
                        <span>5-7 Asesores</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color lila"></div>
                        <span>8+ Asesores</span>
                    </div>
                </div>
            </div>

            <!-- Table Container -->
            <div class="table-container" id="tableContainer">
                <div class="empty-state">
                    <i class="bi bi-table"></i>
                    <h4>Selecciona un Tipo de Horario</h4>
                    <p>Elige un tipo de horario para visualizar la distribución de asesores</p>
                </div>
            </div>

            <!-- Statistics Panel -->
            <div class="statistics-panel mt-4" id="statisticsPanel" style="display: none;">
                <div class="row g-3">
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="bi bi-people-fill"></i>
                            </div>
                            <div class="stat-content">
                                <h4 id="totalAsesores">0</h4>
                                <p>Total Asesores</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="bi bi-clock-fill"></i>
                            </div>
                            <div class="stat-content">
                                <h4 id="totalHoras">0</h4>
                                <p>Total Horas</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="bi bi-calendar-check-fill"></i>
                            </div>
                            <div class="stat-content">
                                <h4 id="horariosCompletos">0</h4>
                                <p>Horarios Completos</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="bi bi-exclamation-triangle-fill"></i>
                            </div>
                            <div class="stat-content">
                                <h4 id="horariosVacios">0</h4>
                                <p>Horarios Vacíos</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer Component -->
    <div id="footer-component"></div>

    <!-- Modal para mostrar asesores -->
    <div class="modal fade" id="asesoresModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-people-fill me-2"></i>
                        <span id="modalTitle">Asesores en Horario</span>
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="modal-info mb-3" id="modalInfo">
                        <!-- Información del horario se cargará aquí -->
                    </div>
                    <div class="asesores-list" id="asesoresList">
                        <!-- Lista de asesores se cargará aquí -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notificaciones -->
    <div id="notification-container"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
    <!-- Firebase Config -->
    <script src="../firebase-config.js"></script>
    <!-- Base Components JS -->
    <script src="../js/components.js"></script>
    <!-- Base Navigation JS -->
    <script src="../js/navigation.js"></script>
    <!-- Page Specific JS -->
    <script id="page-script" src="../js/tabla-horarios.js"></script>
</body>
</html>