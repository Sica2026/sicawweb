<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Armador de Horarios - SICA</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- Base Styles -->
    <link href="../css/base-styles.css" rel="stylesheet">
    <!-- Page Specific Styles -->
    <link id="page-styles" href="../css/armador.css" rel="stylesheet">
</head>
<body>
    <!-- Header Component -->
    <div id="header-component"></div>

    <!-- Navigation Component -->
    <div id="navbar-component"></div>

<!-- Main Content Area -->
    <main class="main-content" id="main-content">
        <div class="container-fluid">
            <!-- Header Section -->
            <div class="page-header">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h1 class="page-title">
                            <i class="bi bi-calendar-week text-gold me-3"></i>
                            Armador de Horarios Interactivo
                        </h1>
                        <p class="page-subtitle">Gestiona tus cursos de manera intuitiva y profesional</p>
                    </div>
                    <div class="col-md-4 text-end">
                        <div class="stats-quick">
                            <div class="stat-item">
                                <span class="stat-label">Total Cursos:</span>
                                <span class="stat-value" id="totalCourses">0</span>
                            </div>
                            <div class="stat-item sica-highlight">
                                <span class="stat-label">Horas SICA:</span>
                                <span class="stat-value" id="sicaHours">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row g-4">
                <!-- Schedule Section -->
                <div class="col-lg-8">
                    <div class="card-modern">
                        <div class="card-header">
                            <h5 class="card-title mb-0">
                                <i class="bi bi-grid-3x3-gap text-blue me-2"></i>
                                Horario Semanal
                            </h5>
                        </div>
                        <div class="card-body p-0">
                            <!-- Selection Info -->
                            <div class="selection-info">
                                <div class="d-flex align-items-center justify-content-between flex-wrap gap-2">
                                    <div class="selection-display">
                                        <span id="selectionCount" class="badge bg-info">0 celdas seleccionadas</span>
                                        <span id="selectionHours" class="text-muted ms-2">(0 horas)</span>
                                    </div>
                                    <button type="button" class="btn btn-sica-outline btn-sm" onclick="clearSelection()">
                                        <i class="bi bi-x-circle me-1"></i>
                                        Limpiar Selección
                                    </button>
                                </div>
                            </div>

                            <!-- Schedule Table -->
                            <div class="table-responsive">
                                <table class="table table-sica mb-0" id="scheduleTable">
                                    <thead>
                                        <tr>
                                            <th style="width: 140px;">Horario</th>
                                            <th>Lunes</th>
                                            <th>Martes</th>
                                            <th>Miércoles</th>
                                            <th>Jueves</th>
                                            <th>Viernes</th>
                                        </tr>
                                    </thead>
                                    <tbody id="scheduleBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Form Section -->
                <div class="col-lg-4">
                    <div class="card-modern sticky-top" style="top: 100px;">
                        <div class="card-header">
                            <h5 class="card-title mb-0">
                                <i class="bi bi-plus-circle text-gold me-2"></i>
                                Agregar Curso
                            </h5>
                        </div>
                        <div class="card-body">
                            <form id="courseForm">
                                <div class="mb-3">
                                    <label for="courseName" class="form-label-sica">Nombre del Curso *</label>
                                    <input type="text" class="form-control form-control-sica" id="courseName" required>
                                </div>

                                <div class="mb-3">
                                    <label for="advisorName" class="form-label-sica">Asesor *</label>
                                    <select class="form-control form-control-sica" id="advisorName" required>
                                        <option value="">Selecciona un asesor...</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label for="administrator" class="form-label-sica">Administrador *</label>
                                    <input type="text" class="form-control form-control-sica" id="administrator" required readonly>
                                </div>

                                <div class="mb-3">
                                    <label for="classroom" class="form-label-sica">Salón *</label>
                                    <input type="text" class="form-control form-control-sica" id="classroom" required>
                                </div>

                                <div class="mb-3">
                                    <label for="building" class="form-label-sica">Edificio *</label>
                                    <input type="text" class="form-control form-control-sica" id="building" required>
                                </div>

                                <div class="mb-3">
                                    <label for="courseColor" class="form-label-sica">Color del Curso</label>
                                    <div class="color-selector">
                                        <input type="color" class="form-control form-control-color" id="courseColor" value="#4facfe">
                                        <div class="color-presets">
                                            <div class="color-preset" data-color="#4facfe" style="background: #4facfe;"></div>
                                            <div class="color-preset" data-color="#ff6b6b" style="background: #ff6b6b;"></div>
                                            <div class="color-preset" data-color="#2ecc71" style="background: #2ecc71;"></div>
                                            <div class="color-preset" data-color="#f39c12" style="background: #f39c12;"></div>
                                            <div class="color-preset" data-color="#9b59b6" style="background: #9b59b6;"></div>
                                            <div class="color-preset" data-color="#e74c3c" style="background: #e74c3c;"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label for="realizationDate" class="form-label-sica">Fecha válida *</label>
                                    <input type="date" class="form-control form-control-sica" id="realizationDate" required>
                                </div>

                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="saveData">
                                        <label class="form-check-label" for="saveData">
                                            Guardar datos para próximo curso
                                        </label>
                                    </div>
                                </div>

                                <div class="d-grid gap-2">
                                    <button type="button" class="btn btn-sica" onclick="addCourse()">
                                        <i class="bi bi-plus-lg me-1"></i>
                                        Agregar Curso
                                    </button>
                                    <div class="btn-group" role="group">
                                        <button type="button" class="btn btn-sica-outline" onclick="clearForm()">
                                            <i class="bi bi-arrow-clockwise me-1"></i>
                                            Limpiar
                                        </button>
                                        <button type="button" class="btn btn-sica-outline" onclick="loadLastData()">
                                            <i class="bi bi-upload me-1"></i>
                                            Cargar Últimos
                                        </button>
                                    </div>
                                </div>

                                <hr class="my-4">

                                <div class="d-grid gap-2">
                                    <button type="button" class="btn btn-success" onclick="generatePDF()">
                                        <i class="bi bi-file-earmark-pdf me-1"></i>
                                        Descargar PDF
                                    </button>
                                    <button type="button" class="btn btn-info" onclick="downloadImage()">
                                        <i class="bi bi-image me-1"></i>
                                        Descargar Imagen
                                    </button>
                                    <button type="button" class="btn btn-danger" onclick="clearAllData()">
                                        <i class="bi bi-trash me-1"></i>
                                        Limpiar Todo
                                    </button>
                                </div>
                            </form>

                            <!-- Saved Data Section -->
                            <div class="saved-data-section mt-4" id="savedDataSection" style="display: none;">
                                <div class="alert-sica alert-sica-info">
                                    <h6><i class="bi bi-info-circle me-1"></i>Datos Guardados:</h6>
                                    <div id="savedDataDisplay"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer Component -->
    <div id="footer-component"></div>

    <!-- Course Details Modal -->
    <div class="modal fade" id="courseModal" tabindex="-1" aria-labelledby="courseModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="courseModalLabel">
                        <i class="bi bi-info-circle text-blue me-2"></i>
                        Detalles del Curso
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="courseDetails"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" onclick="deleteCourse()">
                        <i class="bi bi-trash me-1"></i>
                        Eliminar Curso
                    </button>
                    <button type="button" class="btn btn-sica-outline" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg me-1"></i>
                        Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <!-- PDF and Canvas Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
    <!-- Firebase Config -->
    <script src="../firebase-config.js"></script>
    <!-- Base Components JS -->
    <script src="../js/components.js"></script>
    <!-- Base Navigation JS -->
    <script src="../js/navigation.js"></script>
    <!-- Page Specific JS -->
    <script id="page-script" src="../js/armador.js"></script>
</body>
</html>