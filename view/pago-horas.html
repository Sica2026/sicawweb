<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Pago de Horas - SICA Admin</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- Base Styles -->
    <link href="../css/base-styles.css" rel="stylesheet">
    <!-- Page Specific Styles -->
    <link id="page-styles" href="../css/pago-horas.css" rel="stylesheet">
</head>
<body>
    <!-- Header Component -->
    <div id="header-component"></div>

    <!-- Navigation Component -->
    <div id="navbar-component"></div>

    <!-- Main Content Area -->
    <main class="main-content" id="main-content">
        <!-- Page Header -->
        <div class="page-header">
            <div class="container">
                <div class="header-content">
                    <div class="header-icon">
                        <i class="bi bi-cash-coin"></i>
                    </div>
                    <div class="header-text">
                        <h1 class="page-title">Gestión de Pago de Horas</h1>
                        <p class="page-subtitle">Registro y modificación de horas trabajadas por asesores</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Control Tabs -->
        <div class="container mb-4">
            <div class="control-tabs">
                <button class="tab-btn active" data-tab="nuevo" id="nuevoTab">
                    <i class="bi bi-plus-circle"></i>
                    <span>Nuevo Registro</span>
                </button>
                <button class="tab-btn" data-tab="buscar" id="buscarTab">
                    <i class="bi bi-search"></i>
                    <span>Buscar/Modificar</span>
                </button>
            </div>
        </div>

        <!-- Nuevo Registro Tab -->
        <div class="tab-content active" id="nuevoContent">
            <div class="container">
                <div class="form-card">
                    <div class="card-header">
                        <h3><i class="bi bi-plus-circle-fill me-2"></i>Nuevo Registro de Horas</h3>
                    </div>
                    <div class="card-body">
                        <form id="pagoHorasForm">
                            <div class="row">
                                <!-- Asesor Selector -->
                                <div class="col-md-6 mb-4">
                                    <label class="form-label-sica">
                                        <i class="bi bi-person-fill me-2"></i>Asesor
                                    </label>
                                    <div class="autocomplete-container">
                                        <input type="text" 
                                               class="form-control form-control-sica" 
                                               id="asesorInput" 
                                               placeholder="Buscar asesor por nombre..."
                                               autocomplete="off">
                                        <div class="autocomplete-list" id="asesorList"></div>
                                    </div>
                                    <small class="form-text">
                                        Cuenta: <span id="numeroCuentaDisplay">-</span>
                                    </small>
                                </div>

                                <!-- Sala -->
                                <div class="col-md-6 mb-4">
                                    <label class="form-label-sica">
                                        <i class="bi bi-building me-2"></i>Sala
                                    </label>
                                    <select class="form-control form-control-sica" id="salaSelect" required>
                                        <option value="">Seleccionar sala...</option>
                                        <option value="SICA 1">SICA 1</option>
                                        <option value="SICA 2">SICA 2</option>
                                        <option value="SICA 3">SICA 3</option>
                                        <option value="SICA 4">SICA 4</option>
                                        <option value="SALON INTELIGENTE 1">SALÓN INTELIGENTE 1</option>
                                        <option value="SALON INTELIGENTE 2">SALÓN INTELIGENTE 2</option>
                                    </select>
                                </div>

                                <!-- Fecha -->
                                <div class="col-md-4 mb-4">
                                    <label class="form-label-sica">
                                        <i class="bi bi-calendar3 me-2"></i>Fecha
                                    </label>
                                    <input type="date" 
                                           class="form-control form-control-sica" 
                                           id="fechaInput" 
                                           required>
                                </div>

                                <!-- Hora Inicio -->
                                <div class="col-md-4 mb-4">
                                    <label class="form-label-sica">
                                        <i class="bi bi-clock me-2"></i>Hora Inicio
                                    </label>
                                    <select class="form-control form-control-sica" 
                                            id="horaInicioInput" 
                                            required>
                                        <option value="">Seleccionar hora...</option>
                                        <option value="07:00">07:00 AM</option>
                                        <option value="07:30">07:30 AM</option>
                                        <option value="08:00">08:00 AM</option>
                                        <option value="08:30">08:30 AM</option>
                                        <option value="09:00">09:00 AM</option>
                                        <option value="09:30">09:30 AM</option>
                                        <option value="10:00">10:00 AM</option>
                                        <option value="10:30">10:30 AM</option>
                                        <option value="11:00">11:00 AM</option>
                                        <option value="11:30">11:30 AM</option>
                                        <option value="12:00">12:00 PM</option>
                                        <option value="12:30">12:30 PM</option>
                                        <option value="13:00">01:00 PM</option>
                                        <option value="13:30">01:30 PM</option>
                                        <option value="14:00">02:00 PM</option>
                                        <option value="14:30">02:30 PM</option>
                                        <option value="15:00">03:00 PM</option>
                                        <option value="15:30">03:30 PM</option>
                                        <option value="16:00">04:00 PM</option>
                                        <option value="16:30">04:30 PM</option>
                                        <option value="17:00">05:00 PM</option>
                                        <option value="17:30">05:30 PM</option>
                                        <option value="18:00">06:00 PM</option>
                                        <option value="18:30">06:30 PM</option>
                                        <option value="19:00">07:00 PM</option>
                                        <option value="19:30">07:30 PM</option>
                                        <option value="20:00">08:00 PM</option>
                                        <option value="20:30">08:30 PM</option>
                                        <option value="21:00">09:00 PM</option>
                                    </select>
                                </div>

                                <!-- Hora Fin -->
                                <div class="col-md-4 mb-4">
                                    <label class="form-label-sica">
                                        <i class="bi bi-clock-fill me-2"></i>Hora Fin
                                    </label>
                                    <select class="form-control form-control-sica" 
                                            id="horaFinInput" 
                                            required>
                                        <option value="">Seleccionar hora...</option>
                                        <option value="07:30">07:30 AM</option>
                                        <option value="08:00">08:00 AM</option>
                                        <option value="08:30">08:30 AM</option>
                                        <option value="09:00">09:00 AM</option>
                                        <option value="09:30">09:30 AM</option>
                                        <option value="10:00">10:00 AM</option>
                                        <option value="10:30">10:30 AM</option>
                                        <option value="11:00">11:00 AM</option>
                                        <option value="11:30">11:30 AM</option>
                                        <option value="12:00">12:00 PM</option>
                                        <option value="12:30">12:30 PM</option>
                                        <option value="13:00">01:00 PM</option>
                                        <option value="13:30">01:30 PM</option>
                                        <option value="14:00">02:00 PM</option>
                                        <option value="14:30">02:30 PM</option>
                                        <option value="15:00">03:00 PM</option>
                                        <option value="15:30">03:30 PM</option>
                                        <option value="16:00">04:00 PM</option>
                                        <option value="16:30">04:30 PM</option>
                                        <option value="17:00">05:00 PM</option>
                                        <option value="17:30">05:30 PM</option>
                                        <option value="18:00">06:00 PM</option>
                                        <option value="18:30">06:30 PM</option>
                                        <option value="19:00">07:00 PM</option>
                                        <option value="19:30">07:30 PM</option>
                                        <option value="20:00">08:00 PM</option>
                                        <option value="20:30">08:30 PM</option>
                                        <option value="21:00">09:00 PM</option>
                                    </select>
                                </div>

                                <!-- Quien Autorizó -->
                                <div class="col-12 mb-4">
                                    <label class="form-label-sica">
                                        <i class="bi bi-shield-check me-2"></i>Quien Autorizó
                                    </label>
                                    <input type="text" 
                                           class="form-control form-control-sica" 
                                           id="quienAutorizoInput" 
                                           placeholder="Nombre de quien autorizó el registro"
                                           required>
                                </div>
                            </div>

                            <!-- Resumen -->
                            <div class="summary-card" id="summaryCard" style="display: none;">
                                <h5><i class="bi bi-info-circle me-2"></i>Resumen del Registro</h5>
                                <div class="summary-content" id="summaryContent"></div>
                            </div>

                            <!-- Botones -->
                            <div class="form-actions">
                                <button type="button" class="btn btn-sica-outline" id="limpiarBtn">
                                    <i class="bi bi-arrow-clockwise me-2"></i>Limpiar
                                </button>
                                <button type="submit" class="btn btn-sica" id="guardarBtn">
                                    <i class="bi bi-save me-2"></i>Guardar Registro
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Buscar/Modificar Tab -->
        <div class="tab-content" id="buscarContent">
            <div class="container">
                <!-- Search Card -->
                <div class="form-card mb-4">
                    <div class="card-header">
                        <h3><i class="bi bi-search me-2"></i>Buscar Registros</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <label class="form-label-sica">
                                    <i class="bi bi-person-fill me-2"></i>Asesor
                                </label>
                                <div class="autocomplete-container">
                                    <input type="text" 
                                           class="form-control form-control-sica" 
                                           id="buscarAsesorInput" 
                                           placeholder="Buscar asesor por nombre..."
                                           autocomplete="off">
                                    <div class="autocomplete-list" id="buscarAsesorList"></div>
                                </div>
                                <small class="form-text">
                                    Cuenta: <span id="buscarNumeroCuentaDisplay">-</span>
                                </small>
                            </div>
                            <div class="col-md-6 d-flex align-items-end">
                                <button class="btn btn-sica" id="buscarBtn">
                                    <i class="bi bi-search me-2"></i>Buscar
                                </button>
                                <button class="btn btn-sica-outline ms-2" id="limpiarBusquedaBtn">
                                    <i class="bi bi-x-circle me-2"></i>Limpiar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Table -->
                <div class="results-card" id="resultsCard" style="display: none;">
                    <div class="card-header">
                        <h3><i class="bi bi-table me-2"></i>Registros Encontrados</h3>
                        <span class="results-count" id="resultsCount">0 registros</span>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sica" id="registrosTable">
                                <thead>
                                    <tr>
                                        <th>Asesor</th>
                                        <th>Sala</th>
                                        <th>Fecha</th>
                                        <th>Horario</th>
                                        <th>Horas</th>
                                        <th>Autorizado por</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="registrosTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Modal -->
        <div class="modal fade" id="editModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content modal-sica">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="bi bi-pencil-square me-2"></i>Editar Registro
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="editForm">
                            <input type="hidden" id="editRegistroId">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label-sica">Asesor</label>
                                    <input type="text" class="form-control form-control-sica" id="editAsesor" readonly>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label-sica">Sala</label>
                                    <select class="form-control form-control-sica" id="editSala" required>
                                        <option value="SICA 1">SICA 1</option>
                                        <option value="SICA 2">SICA 2</option>
                                        <option value="SICA 3">SICA 3</option>
                                        <option value="SICA 4">SICA 4</option>
                                        <option value="SALON INTELIGENTE 1">SALÓN INTELIGENTE 1</option>
                                        <option value="SALON INTELIGENTE 2">SALÓN INTELIGENTE 2</option>
                                    </select>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label class="form-label-sica">Fecha</label>
                                    <input type="date" class="form-control form-control-sica" id="editFecha" required>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label class="form-label-sica">Hora Inicio</label>
                                    <select class="form-control form-control-sica" id="editHoraInicio" required>
                                        <option value="07:00">07:00 AM</option>
                                        <option value="07:30">07:30 AM</option>
                                        <option value="08:00">08:00 AM</option>
                                        <option value="08:30">08:30 AM</option>
                                        <option value="09:00">09:00 AM</option>
                                        <option value="09:30">09:30 AM</option>
                                        <option value="10:00">10:00 AM</option>
                                        <option value="10:30">10:30 AM</option>
                                        <option value="11:00">11:00 AM</option>
                                        <option value="11:30">11:30 AM</option>
                                        <option value="12:00">12:00 PM</option>
                                        <option value="12:30">12:30 PM</option>
                                        <option value="13:00">01:00 PM</option>
                                        <option value="13:30">01:30 PM</option>
                                        <option value="14:00">02:00 PM</option>
                                        <option value="14:30">02:30 PM</option>
                                        <option value="15:00">03:00 PM</option>
                                        <option value="15:30">03:30 PM</option>
                                        <option value="16:00">04:00 PM</option>
                                        <option value="16:30">04:30 PM</option>
                                        <option value="17:00">05:00 PM</option>
                                        <option value="17:30">05:30 PM</option>
                                        <option value="18:00">06:00 PM</option>
                                        <option value="18:30">06:30 PM</option>
                                        <option value="19:00">07:00 PM</option>
                                        <option value="19:30">07:30 PM</option>
                                        <option value="20:00">08:00 PM</option>
                                        <option value="20:30">08:30 PM</option>
                                        <option value="21:00">09:00 PM</option>
                                    </select>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label class="form-label-sica">Hora Fin</label>
                                    <select class="form-control form-control-sica" id="editHoraFin" required>
                                        <option value="07:30">07:30 AM</option>
                                        <option value="08:00">08:00 AM</option>
                                        <option value="08:30">08:30 AM</option>
                                        <option value="09:00">09:00 AM</option>
                                        <option value="09:30">09:30 AM</option>
                                        <option value="10:00">10:00 AM</option>
                                        <option value="10:30">10:30 AM</option>
                                        <option value="11:00">11:00 AM</option>
                                        <option value="11:30">11:30 AM</option>
                                        <option value="12:00">12:00 PM</option>
                                        <option value="12:30">12:30 PM</option>
                                        <option value="13:00">01:00 PM</option>
                                        <option value="13:30">01:30 PM</option>
                                        <option value="14:00">02:00 PM</option>
                                        <option value="14:30">02:30 PM</option>
                                        <option value="15:00">03:00 PM</option>
                                        <option value="15:30">03:30 PM</option>
                                        <option value="16:00">04:00 PM</option>
                                        <option value="16:30">04:30 PM</option>
                                        <option value="17:00">05:00 PM</option>
                                        <option value="17:30">05:30 PM</option>
                                        <option value="18:00">06:00 PM</option>
                                        <option value="18:30">06:30 PM</option>
                                        <option value="19:00">07:00 PM</option>
                                        <option value="19:30">07:30 PM</option>
                                        <option value="20:00">08:00 PM</option>
                                        <option value="20:30">08:30 PM</option>
                                        <option value="21:00">09:00 PM</option>
                                    </select>
                                </div>
                                <div class="col-12 mb-3">
                                    <label class="form-label-sica">Quien Autorizó</label>
                                    <input type="text" class="form-control form-control-sica" id="editQuienAutorizo" required>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-sica-outline" data-bs-dismiss="modal">Cancelar</button>
                        <button type="button" class="btn btn-sica" id="guardarEditBtn">
                            <i class="bi bi-save me-2"></i>Guardar Cambios
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loadingOverlay">
            <div class="loading-spinner">
                <div class="spinner-border text-gold" role="status">
                    <span class="visually-hidden">Cargando...</span>
                </div>
                <p class="mt-3">Procesando...</p>
            </div>
        </div>
    </main>

    <!-- Footer Component -->
    <div id="footer-component"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
    <!-- Firebase Config -->
    <script src="../firebase-config.js"></script>
    <!-- Base Components JS -->
    <script src="../js/components.js"></script>
    <!-- Base Navigation JS -->
    <script src="../js/navigation.js"></script>
    <!-- Page Specific JS -->
    <script id="page-script" src="../js/pago-horas.js"></script>
</body>
</html>