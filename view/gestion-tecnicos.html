<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Técnicos - SICA Admin</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- Base Styles -->
    <link href="../css/base-styles.css" rel="stylesheet">
    <!-- Gestión Técnicos Styles -->
    <link href="../css/gestion-tecnicos.css" rel="stylesheet">
</head>
<body class="admin-authenticated">
    <!-- Header Component -->
    <div id="header-component"></div>

    <!-- Navigation Component -->
    <div id="navbar-component"></div>

    <!-- Main Content Area -->
    <main class="main-content" id="main-content">
        <div class="container-fluid">
            <!-- Page Header -->
            <div class="page-header mb-5">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <div class="header-content">
                            <h1 class="page-title">
                                <i class="bi bi-tools me-3"></i>
                                Centro de Gestión de Técnicos
                            </h1>
                            <p class="page-subtitle">
                                Administra el equipo técnico del sistema SICA y sus salas asignadas
                            </p>
                        </div>
                    </div>
                    <div class="col-md-4 text-end">
                        <div class="header-stats">
                            <div class="stat-item">
                                <span class="stat-number" id="totalTecnicos">0</span>
                                <span class="stat-label">Técnicos Activos</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="totalSalas">0</span>
                                <span class="stat-label">Salas Asignadas</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Control Panel -->
            <div class="control-panel mb-4">
                <div class="panel-left">
                    <button class="control-btn success-btn" onclick="openNuevoTecnico()">
                        <i class="bi bi-person-plus"></i>
                        <span>Nuevo Técnico</span>
                    </button>
                </div>
                <div class="panel-right">
                    <div class="search-container">
                        <input type="text" id="searchInput" placeholder="Buscar técnico...">
                        <i class="bi bi-search search-icon"></i>
                    </div>
                    <div class="filter-container">
                        <select id="filterSelect">
                            <option value="todos">Todos</option>
                            <option value="activo" selected>Activos</option>
                            <option value="inactivo">Inactivos</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Tabla de Técnicos -->
            <div class="tecnicos-container">
                <div class="table-responsive">
                    <table class="table tecnicos-table" id="tecnicosTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Usuario</th>
                                <th>Nombre</th>
                                <th>Salas Asignadas</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tecnicosTableBody">
                            <!-- Las filas se generarán dinámicamente -->
                        </tbody>
                    </table>
                </div>

                <!-- Loading State -->
                <div class="loading-state" id="loadingState">
                    <div class="loading-spinner"></div>
                    <p>Cargando técnicos...</p>
                </div>

                <!-- Empty State -->
                <div class="empty-state" id="emptyState" style="display: none;">
                    <div class="empty-icon">
                        <i class="bi bi-person-x"></i>
                    </div>
                    <h3>No hay técnicos registrados</h3>
                    <p>Comienza agregando tu primer técnico al sistema</p>
                    <button class="btn btn-primary" onclick="openNuevoTecnico()">
                        <i class="bi bi-person-plus me-2"></i>
                        Agregar Técnico
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer Component -->
    <div id="footer-component"></div>

    <!-- Modal de Técnico (Crear/Editar) -->
    <div class="modal fade" id="tecnicoModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="tecnicoModalTitle">
                        <i class="bi bi-person-gear me-2"></i>
                        Información del Técnico
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="tecnicoForm">
                        <!-- Información Básica -->
                        <div class="form-section mb-4">
                            <h5><i class="bi bi-person-circle me-2"></i>Información Básica</h5>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Usuario *</label>
                                    <input type="text" class="form-control" id="usuario" required placeholder="juan.perez">
                                    <small class="text-muted">Único, sin espacios</small>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Contraseña *</label>
                                    <div class="password-input-wrapper">
                                        <input type="password" class="form-control" id="contrasena" required>
                                        <button type="button" class="password-toggle-btn" onclick="togglePassword()">
                                            <i class="bi bi-eye" id="passwordToggleIcon"></i>
                                        </button>
                                    </div>
                                    <small class="text-muted">Se guardará en texto plano</small>
                                </div>
                                <div class="col-md-12">
                                    <label class="form-label">Nombre Completo *</label>
                                    <input type="text" class="form-control" id="nombre" required placeholder="Juan Pérez García">
                                </div>
                            </div>
                        </div>

                        <!-- Salas Asignadas -->
                        <div class="form-section mb-4">
                            <h5><i class="bi bi-building me-2"></i>Salas Asignadas</h5>
                            <p class="text-muted mb-3">Selecciona las salas a las que el técnico tendrá acceso</p>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="form-check-custom">
                                        <input type="checkbox" class="form-check-input" id="sala_sica1" value="Sica 1">
                                        <label class="form-check-label" for="sala_sica1">
                                            <i class="bi bi-pc-display me-2"></i>Sica 1
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check-custom">
                                        <input type="checkbox" class="form-check-input" id="sala_sica2" value="Sica 2">
                                        <label class="form-check-label" for="sala_sica2">
                                            <i class="bi bi-pc-display me-2"></i>Sica 2
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check-custom">
                                        <input type="checkbox" class="form-check-input" id="sala_sica3" value="Sica 3">
                                        <label class="form-check-label" for="sala_sica3">
                                            <i class="bi bi-pc-display me-2"></i>Sica 3
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check-custom">
                                        <input type="checkbox" class="form-check-input" id="sala_sica4" value="Sica 4">
                                        <label class="form-check-label" for="sala_sica4">
                                            <i class="bi bi-pc-display me-2"></i>Sica 4
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check-custom">
                                        <input type="checkbox" class="form-check-input" id="sala_si1" value="Salón Inteligente 1">
                                        <label class="form-check-label" for="sala_si1">
                                            <i class="bi bi-mortarboard me-2"></i>Salón Inteligente 1
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check-custom">
                                        <input type="checkbox" class="form-check-input" id="sala_si2" value="Salón Inteligente 2">
                                        <label class="form-check-label" for="sala_si2">
                                            <i class="bi bi-mortarboard me-2"></i>Salón Inteligente 2
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Estado -->
                        <div class="form-section">
                            <h5><i class="bi bi-info-circle me-2"></i>Estado</h5>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Estado del Técnico</label>
                                    <select class="form-control" id="estado">
                                        <option value="activo">Activo</option>
                                        <option value="inactivo">Inactivo</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle me-1"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="guardarTecnico()">
                        <i class="bi bi-save me-1"></i>Guardar Técnico
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Detalle (Ver) -->
    <div class="modal fade" id="verTecnicoModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-eye me-2"></i>
                        Detalles del Técnico
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="verTecnicoContent">
                    <!-- Se llenará dinámicamente -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notificaciones -->
    <div id="notification-container"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

    <!-- Firebase Config -->
    <script src="../firebase-config.js"></script>

    <!-- Base Components JS -->
    <script src="../js/components.js"></script>
    <!-- Base Navigation JS -->
    <script src="../js/navigation.js"></script>
    <!-- Acceso global a modo técnico (Alt + T) -->
    <script src="../js/global-technician-shortcut.js"></script>
    <!-- Gestión Técnicos JS -->
    <script src="../js/gestion-tecnicos.js"></script>
</body>
</html>
